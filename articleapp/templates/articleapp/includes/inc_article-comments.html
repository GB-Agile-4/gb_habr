<div class="articles-list">
    <div class="articles-list-item">
        <div class="article-snippet">
            <h2 class="comments-wrapper__title">
                {% with comments.count as total_comments %}
                <span class="comments-wrapper__comments-count">
                                        <h3>
                                            Комментарии: {{ total_comments }}
                                        </h3>
                            {% endwith %}
                             </span></h2>
            {% for comment in comments %}
            {% if not comment.parent.id %}
            <div class="comment">
                <h5 class="info">
                    {{ comment.comment_author }}
                    {{ comment.updated_at}}
                </h5>
                <p>
                    {{ comment.body|linebreaks }}
                </p>
                <table width="100%">
                    <tr>
                        <td width="50%">
                            <a class="btn" href="{% url 'like:comment_like' comment.pk %}">
                                <i style="color:#000000" class="fa fa-thumbs-o-up fa-1x"></i>
                            </a>
                            <span class="lead">{{ comment.likes }}</span>
                            <a class="btn" href="/like/comment_dislike/{{ comment.pk }}">
                                <i style="color:#000000" class="fa fa-thumbs-o-up fa-1x fa-rotate-180"></i>
                            </a>
                            <span class="lead" style="color:#000000">{{ comment.dislikes }}</span>
                        </td>
                        <td width="50%">
                            {% if user != comment.comment_author and not comment.parent.id %}
                            <a class="btn btn-outline-secondary" style="float: right;"
                               href="{% url 'comment:add_reply' comment.pk %}">
                                Ответить
                            </a>
                            {% endif %}
                            {% if comment.comment_author == user or user.is_staff %}
                            <a class="btn btn-outline-danger" style="float: right;"
                               href="{% url 'comment:delete' comment.pk %}">
                                Удалить
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                </table>
                {% for comment_reply in comment.replies.all %}
                {% if comment_reply %}
                <div class="comment">
                    <h5 class="info">
                    {{ comment_reply.comment_author }}
                    {{ comment_reply.updated_at}}
                </h5>
                <p>
                    {{ comment_reply.body|linebreaks }}
                </p>
                <table width="100%">
                    <tr>
                        <td width="50%">
                            <a class="btn" href="{% url 'like:comment_like' comment_reply.pk %}">
                                <i style="color:#000000" class="fa fa-thumbs-o-up fa-1x"></i>
                            </a>
                            <span class="lead">{{ comment.likes }}</span>
                            <a class="btn" href="/like/comment_dislike/{{ comment_reply.pk }}">
                                <i style="color:#000000" class="fa fa-thumbs-o-up fa-1x fa-rotate-180"></i>
                            </a>
                            <span class="lead" style="color:#000000">{{ comment.dislikes }}</span>
                        </td>
                        <td width="50%">
                            {% if user != comment_reply.comment_author %}
                            <a class="btn btn-outline-secondary" style="float: right;"
                               href="{% url 'comment:add_reply' comment_reply.pk %}">
                                Ответить
                            </a>
                            {% endif %}
                            {% if comment_reply.comment_author == user or user.is_staff %}
                            <a class="btn btn-outline-danger" style="float: right;"
                               href="{% url 'comment:delete' comment_reply.pk %}">
                                Удалить
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                </table>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% endif %}
            {% empty %}
            <p>Пока комментариев нет</p>
            {% endfor %}


            <a class="btn btn-outline-secondary"
               href="{% url 'comment:add' article.pk %}">
                Добавить комментарий
            </a>
            </tr>
            </table>
        </div>
    </div>
</div>
